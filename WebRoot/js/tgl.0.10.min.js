function tgl(par){function main(par){var inp=document.getElementById(par.input);var days={};var months={};days.id=["minggu","senin","selasa","rabu","kamis","jumat","sabtu"];months.id=["januari","februari","maret","april","mei","juni","juli","agustus","september","oktober","november","desember"];days.en=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];months.en=["january","february","march","april","may","june","july","august","september","october","november","december"];var listDay=days.en;var listMonth=months.en;if(par.day!==undefined){var mainDays=days.en;for(var a in par.day){days[a]=[];for(var b in mainDays){if(par.day[a][b]===undefined){days[a][b]=mainDays[b];}else{days[a][b]=par.day[a][b];}}}} if(par.month!==undefined){var mainMonths=months.en;for(var c in par.month){months[c]=[];for(var d in mainMonths){if(par.month[c][d]===undefined){months[c][d]=mainMonths[d];}else{months[c][d]=par.month[c][d];}}}} if(par.region!==undefined){if(days[par.region]!==undefined){listDay=days[par.region];}if(months[par.region]!==undefined){listMonth=months[par.region];}} var formatDate={d:function(t){return t.getDate();},dd:function(t){t=t.getDate();t<10?t='0'+t:t;return t;},ddd:function(t){return listDay[t.getDay()].substr(0,3);},dddd:function(t){return listDay[t.getDay()];},m:function(t){return t.getMonth()+1;},mm:function(t){t=t.getMonth()+1;t<10?t='0'+t:t;return t;},mmm:function(t){return listMonth[t.getMonth()].substr(0,3);},mmmm:function(t){return listMonth[t.getMonth()];},y:function(t){t=t.getFullYear()+'';return t.substr(-2);},yy:function(t){t=t.getFullYear()+'';return t.substr(-2);},yyy:function(t){return t.getFullYear();},yyyy:function(t){return t.getFullYear();},s:function(t){return t.getSeconds();},ss:function(t){t=t.getSeconds();t<10?t='0'+t:t;return t;},n:function(t){return t.getMinutes();},nn:function(t){t=t.getMinutes();t<10?t='0'+t:t;return t;},h:function(t){return t.getHours();},hh:function(t){t=t.getHours();t<10?t='0'+t:t;return t;},};var dateFormat={d:function(t,it){t.da=Number(it);return t;},dd:function(t,it){t.da=Number(it);return t;},m:function(t,it){t.mo=it-1;return t;},mm:function(t,it){t.mo=it-1;return t;},mmm:function(t,it){for(var a in listMonth){if(listMonth[a].toLowerCase().substr(0,3)==it){t.mo=a;return t;}}},mmmm:function(t,it){t.mo=listMonth.indexOf(it.toLowerCase());return t;},y:function(t,it){t.ye='20'+it;return t;},yy:function(t,it){t.ye='20'+it;return t;},yyy:function(t,it){t.ye=it;return t;},yyyy:function(t,it){t.ye=it;return t;},s:function(t,it){t.se=Number(it);return t;},ss:function(t,it){t.se=Number(it);return t;},n:function(t,it){t.mi=Number(it);return t;},nn:function(t,it){t.mi=Number(it);return t;},h:function(t,it){t.ho=Number(it);return t;},hh:function(t,it){t.ho=Number(it);return t;},};if(par.format===undefined||par.format===null||par.format===""){par.format='yyyy-m-d';} var splitFormat=par.format.split('');var no=0;var format=[];for(var e in splitFormat){if(formatDate[splitFormat[e]]===undefined){no++;format[no]=splitFormat[e];no++;}else{if(format[no]===undefined){format[no]=splitFormat[e];}else{format[no]+=splitFormat[e];}}} if(par.shortDay!==undefined&&isNaN(par.shortDay)===false){var shortDay=par.shortDay;} var clasStyle='theme';if(par.clasStyle!==undefined&&par.clasStyle!==null&&par.clasStyle!==""){clasStyle=par.clasStyle;} var fileCss="css/"+clasStyle+".css";if(par.fileCss!==undefined&&par.fileCss!==null&&par.fileCss!==""){fileCss=par.fileCss;} var foundCss=false;var allCss=document.getElementsByTagName('link');for(var f=0;f<allCss.length;f++){if(allCss[f].getAttribute('href')==fileCss){foundCss=true;}} if(foundCss===false&&fileCss!==""){var createCss=document.createElement('link');createCss.setAttribute("rel","stylesheet");createCss.setAttribute("type","text/css");createCss.setAttribute("href",fileCss);inp.parentNode.insertBefore(createCss,inp);} function convertFormat(tt){var result=[];for(var a in format){if(formatDate[format[a]]!==undefined){result[a]=formatDate[format[a]](tt);}else{result[a]=format[a];}}return result.join('');} function convertDate(tt){tt=tt.trim().split('');var pi=[];var no=0;var cc='';for(var t in tt){cc=tt[t].charCodeAt(0);if(cc>=48&&cc<=57||cc>=65&&cc<=90||cc>=97&&cc<=122){if(pi[no]===undefined){pi[no]=tt[t];}else{pi[no]+=tt[t];}}else{no++;pi[no]=tt[t];no++;}}var tg={da:1,mo:0,ye:2000,se:1,mi:1,ho:1,};for(var a in format){if(dateFormat[format[a]]!==undefined){tg=dateFormat[format[a]](tg,pi[a]);}}return new Date(tg.ye,tg.mo,tg.da,tg.ho,tg.mi,tg.se);} function clickDate(obj){dateObj.setDate(obj.innerHTML);inp.value=convertFormat(dateObj);calendar();} function clickMonth(obj){dateObj.setMonth(obj.getAttribute('monthvalue'));inp.value=convertFormat(dateObj);boxCal.setAttribute("monthvalue",obj.getAttribute("monthvalue"));calendar();} function createMonth(){var divmonth="";for(var e=0;e<listMonth.length;e++){if(e==boxCal.getAttribute('monthvalue')){divmonth+="<div class='monthCl monthSel' monthvalue='"+e+"'>"+listMonth[e]+"</div>";}else{divmonth+="<div class='monthCl' monthvalue='"+e+"'>"+listMonth[e]+"</div>";}}var monthdiv=document.createElement('div');monthdiv.setAttribute("id","monthsId");monthdiv.innerHTML=divmonth;boxCal.insertBefore(monthdiv,boxCal.firstChild.nextSibling);} function clickYear(obj){dateObj.setYear(obj.getAttribute('yearvalue'));inp.value=convertFormat(dateObj);boxCal.setAttribute("yearvalue",obj.getAttribute("yearvalue"));calendar();} function createYear(){var divyear="";var yearvalue=Number(boxCal.getAttribute('yearvalue'));var yearstart=yearvalue-6;var yearend=yearvalue+5;for(var g=yearstart;g<=yearend;g++){if(g==yearvalue){divyear+="<div class='yearCl yearSel' yearvalue='"+g+"'>"+g+"</div>";}else{divyear+="<div class='yearCl' yearvalue='"+g+"'>"+g+"</div>";}}var yeardiv=document.createElement('div');yeardiv.setAttribute("id","yearsId");yeardiv.innerHTML=divyear;boxCal.appendChild(yeardiv);}function showMonthYear(attr,obj){if(boxCal.getAttribute(attr)===null){boxCal.setAttribute(attr,obj.getAttribute(attr));}else{boxCal.removeAttribute(attr);}calendar();} var dateObj='';function createDate(){if(inp.value.trim()===""){dateObj=new Date();inp.value="";}else{dateObj=convertDate(inp.value);if(isNaN(dateObj)){dateObj=new Date();}else{inp.value=convertFormat(dateObj);}}var dateSel=dateObj.getDate();var monthNow=dateObj.getMonth();var monthNameNow=listMonth[dateObj.getMonth()];var yearNow=dateObj.getFullYear();var divbar="";divbar+="<div id='contMonth'><h2 id='monthId' monthvalue='"+monthNow+"'>"+monthNameNow+"</h2></div>";divbar+="<div id='contYear'><h2 id='yearId' yearvalue='"+yearNow+"'>"+yearNow+"</h2></div>";var divweek="";for(var a in listDay){if(shortDay!==undefined){divweek+="<th class='dayCl'>"+listDay[a].substr(0,shortDay)+"</th>";}else{divweek+="<th class='dayCl'>"+listDay[a]+"</th>";}}var divdate="";var datevar=new Date(dateObj);datevar.setDate(1);var datestart=datevar.getDate();var daystart=datevar.getDay();var monthstart=datevar.getMonth();var br=0;do{if(br===0){divdate+="<tr>";}while(br<daystart){br++;divdate+="<td></td>";}if(datestart===dateSel){divdate+="<td class='dateCl dateSel'>"+datestart+"</td>";}else{divdate+="<td class='dateCl'>"+datestart+"</td>";}br++;if(br>=listDay.length){divdate+="</tr>";br=0;}datevar.setDate(datestart+1);datestart=datevar.getDate();daystart=datevar.getDay();monthstart=datevar.getMonth();}while(monthstart==monthNow);if(br!==0){while(br<listDay.length){br++;divdate+="<td></td>";}}divdate+="</tr>";var calendar=document.createElement('div');calendar.setAttribute("id","calendar");calendar.innerHTML=divbar+"<table><tr>"+divweek+"</tr>"+divdate+"</table>";boxCal.insertBefore(calendar,boxCal.firstChild);boxCal.style.left=inp.offsetLeft+"px";}var prevent=false;function watchEvent(event){var tglClick=event.target||event.srcElement;var tglCl=tglClick.getAttribute('class');var tglId=tglClick.getAttribute('id');var inpId=inp.getAttribute('id');var inpKey=event.keyCode;if(tglCl==='dateCl'){clickDate(tglClick);}else if(tglId==='monthId'){showMonthYear('monthvalue',tglClick);}else if(tglCl==='monthCl'){clickMonth(tglClick);}else if(tglId==='yearId'){showMonthYear('yearvalue',tglClick);}else if(tglCl==='yearCl'){clickYear(tglClick);}else if(inpKey!==0){if(document.addEventListener){document.removeEventListener("mousedown",watchEvent,true);document.removeEventListener("keydown",watchEvent,true);}else if(document.attachEvent){document.detachEvent("mousedown",watchEvent);document.detachEvent("keydown",watchEvent,true);}boxCal.parentNode.removeChild(boxCal);boxCal=false;}else if(boxCal!==false){if(document.addEventListener){document.removeEventListener("mousedown",watchEvent,true);document.removeEventListener("keydown",watchEvent,true);}else if(document.attachEvent){document.detachEvent("mousedown",watchEvent);document.detachEvent("keydown",watchEvent,true);}boxCal.parentNode.removeChild(boxCal);boxCal=false;if(inpId===tglId){prevent=true;}}} var boxCal=false;function calendar(){var showmonth=null;var showyear=null;if(boxCal===false){ if(document.addEventListener){document.addEventListener("mousedown",watchEvent,true);document.addEventListener("keydown",watchEvent,true);}else if(document.attachEvent){document.attachEvent("mousedown",watchEvent);document.attachEvent("keydown",watchEvent,true);}}else{showmonth=boxCal.getAttribute('monthvalue');showyear=boxCal.getAttribute('yearvalue');boxCal.parentNode.removeChild(boxCal);}boxCal=document.createElement('div');boxCal.setAttribute("id","boxCal");boxCal.setAttribute("class",clasStyle);inp.parentNode.insertBefore(boxCal,inp.nextSibling);createDate();if(showmonth!==null){boxCal.setAttribute("monthvalue",showmonth);createMonth();}if(showyear!==null){boxCal.setAttribute("yearvalue",showyear);createYear();}}function inpFocus(){if(prevent===false){calendar();}}function inpDown(){if(prevent===false){calendar();}else{prevent=false;}}if(inp.addEventListener){inp.addEventListener("focus",inpFocus);inp.addEventListener("click",inpDown);}else if(document.attachEvent){inp.attachEvent("focus",inpFocus);inp.attachEvent("click",inpDown);}} if(document.getElementById(par.input)!==null){main(par);}else{console.log("tgl.js : input id [" + par.input + "] null");}}
